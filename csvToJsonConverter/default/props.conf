# Splunk props.conf for CSV data sourcetype
# Configure field extraction and parsing for CSV events

[csv_data]
SHOULD_LINEMERGE = false
TRUNCATE = 0
TIME_PREFIX = \"time\":
TIME_FORMAT = %s.%3N
MAX_TIMESTAMP_LOOKAHEAD = 32
KV_MODE = json
EXTRACT-csv_fields = \"event\":{(?<csv_event>.+)}
EVAL-_time = if(isnull(_time), now(), _time)

# Field transformations
EVAL-host = coalesce(host, "csv-input-script")
EVAL-source = coalesce(source, "unknown.csv")

# Set index-time field extractions if needed
# TRANSFORMS-csv_extract = csv_field_extraction